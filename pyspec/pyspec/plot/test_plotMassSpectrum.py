from pyspec.plot.plot_mass_spectrum import plot_mass_spectrum, plot_head_to_tail_mass_spectra, plot_multiple_mass_spectra


v10 = '103.0741:2.74 105.0372:1.45 108.9941:1.10 111.9777:1.38 117.0345:3.26 118.0312:2.25 121.0493:1.68 132.9331:1.23 133.0771:1.03 134.0345:2.41 135.1196:1.11 140.9082:1.36 145.0287:13.10 147.1014:2.36 149.0582:5.85 152.0416:1.42 163.0395:7.72 175.4897:1.26 176.5551:1.36 176.6826:1.32 176.7826:2.92 176.9350:3.74 177.0548:999.00 177.5086:2.15 177.5844:1.39 177.6413:0.99 177.7098:0.90 177.8799:2.69 177.9635:0.20 178.1490:1.58 178.2199:1.36 178.2857:1.01 178.3648:3.14 178.4265:1.64 178.5393:1.05 178.6133:0.66 178.9105:1.29 179.0043:1.38 179.3957:1.40 181.0765:2.27 182.0785:1.54 189.1620:1.47 191.1032:1.11 195.0619:1.38 196.0689:1.82 209.1214:1.11 214.9337:8.59 219.0618:1.24 219.1164:1.35 229.9824:1.39 243.0385:1.13 244.8717:1.12 247.0463:1.29 249.0657:1.30 249.5660:1.35 255.0029:1.44 263.1613:1.71 267.0327:1.15 269.0983:1.15 272.0339:1.18 272.9801:1.33 273.0714:1.29 276.0349:1.51 276.3263:1.42 281.0740:1.09 290.9252:2.92 291.0501:3.88 291.1132:3.31 291.9353:1.18 292.0698:1.29 292.9437:14.29 293.0631:2.06 294.0619:1.09 309.0150:1.65 310.1308:1.04 331.0879:1.75 332.9923:1.16 333.8802:1.17 347.5389:1.37 351.1173:2.87 353.0660:1.88 354.0945:1.41 354.1952:1.26 369.1378:17.21 369.3004:1.17 370.2203:2.38 371.1587:11.87 371.3037:1.77 372.2160:4.70 372.9924:1.44 647.8277:1.28 669.5998:1.18 697.2187:1.41 715.6761:1.28'
v20 = '101.0031:1.43 103.0343:1.72 103.0765:5.57 105.0656:2.47 106.0135:1.49 107.0856:1.52 111.0383:3.52 112.0491:1.54 117.0326:26.38 121.0565:2.40 123.1247:1.07 126.9645:1.31 133.0843:2.10 134.0333:3.28 134.9733:1.19 136.9346:1.73 139.0342:1.59 143.1173:1.18 145.0277:77.74 147.0453:2.32 149.0610:21.38 158.9950:1.26 160.9272:1.51 162.0286:3.63 162.9698:2.28 163.0410:5.46 165.1117:1.55 167.9941:1.56 176.3842:1.45 176.7413:1.38 176.8869:1.33 177.0540:999.00 177.4433:1.43 177.5354:2.11 177.5887:2.00 177.6676:0.72 177.8158:3.10 177.9037:2.72 178.1943:3.61 178.5156:1.63 178.6166:1.20 178.8863:0.97 179.3963:0.99 179.5731:0.97 181.0784:1.02 185.0995:1.49 187.0069:1.10 189.0881:1.27 189.1615:1.79 192.1421:1.53 195.0740:2.15 197.8936:1.96 198.1300:1.35 198.9461:1.07 203.9733:1.27 209.1310:1.86 210.0069:1.09 211.4895:1.52 213.0439:1.98 214.0503:1.44 214.9307:18.70 215.9213:2.06 219.0366:1.32 221.1216:1.08 230.9968:1.41 233.0278:1.23 243.9976:1.66 246.1844:1.36 249.0144:1.15 255.1326:1.18 267.4865:1.34 269.0907:1.22 275.0276:1.26 276.9342:1.12 280.0356:1.25 288.8966:1.24 291.0835:1.72 291.1308:1.02 292.9482:1.63 293.0622:3.36 299.0601:1.16 351.1128:1.68 353.0858:1.91 354.1213:0.98 369.1852:3.11 369.2755:1.57 370.1700:2.46 371.1623:6.15 382.9917:1.10 403.0011:1.15 506.9748:1.02 690.4317:1.06 753.5586:1.52 1514.2903:1.55'
v40 = [[100.9673, 4.75], [101.0347, 6.77], [103.0546, 21.91], [105.0134, 6.45], [106.0414, 39.72], [107.0416, 10.39], [110.9571, 6.35], [111.0437, 24.03], [116.7292, 5.62], [116.9670, 23.50], [117.0327, 942.66], [117.1611, 4.17], [117.3224, 5.55], [117.4032, 3.83], [117.4401, 5.55], [117.7310, 4.67], [121.0628, 24.07], [122.9740, 6.06], [124.0619, 8.92], [124.9907, 7.59], [125.9011, 4.33], [131.0555, 5.23], [132.0559, 5.95], [132.9559, 5.13], [134.0351, 215.73], [134.9743, 21.48], [136.9305, 37.63], [137.9696, 5.60], [139.0037, 4.91], [140.7468, 4.27], [140.9149, 9.24], [144.9192, 8.13], [145.0277, 700.58], [145.1676, 4.88], [145.2305, 4.15], [145.4141, 5.51], [145.4459, 6.64], [145.4897, 3.89], [145.9260, 5.52], [146.9919, 5.90], [147.0371, 21.88], [148.9351, 6.95], [149.0594, 547.84], [149.2885, 4.72], [149.3432, 4.04], [149.4534, 5.82], [150.5022, 4.46], [152.0551, 8.27], [154.9394, 4.27], [156.8967, 5.32], [158.5049, 6.50], [158.9799, 5.51], [159.0487, 10.82], [160.9688, 5.89], [162.0336, 50.41], [163.0342, 24.78], [166.9910, 7.86], [169.0572, 5.95], [170.0180, 6.34], [176.9692, 11.61], [177.0536, 999.00], [177.2249, 6.99], [177.6057, 5.05], [177.7114, 3.80], [177.8650, 4.45], [177.9531, 7.44], [178.3560, 4.29], [178.9257, 4.79], [184.0272, 4.72], [189.0600, 4.43], [194.0600, 6.38], [202.0219, 5.02], [209.1191, 4.15], [213.0940, 5.15], [214.9298, 5.35], [247.3980, 4.64], [250.0470, 3.71], [258.9200, 5.31], [264.0410, 4.31], [265.9552, 4.03], [266.0991, 4.02], [307.0557, 4.90], [327.7434, 8.17], [354.9976, 4.20], [415.0601, 3.86], [472.5328, 4.20], [864.3606, 4.25], [945.7245, 6.42], [1004.1066, 6.07], [1088.4578, 5.10], [1244.0887, 3.61]]


def test_simple_spectrum_plot():
    plot_mass_spectrum(v20, 'test_single_1.png',
                       title='MZNIJRAPCCELQX-AWOKGZDASA-N: methyl chlorogenate [M+H]+ 10 V', dpi=100)

def test_simple_spectrum_plot_zoom():
    plot_mass_spectrum(v20, 'test_single_2.png', mz_min=70, mz_max=420,
                       title='MZNIJRAPCCELQX-AWOKGZDASA-N: methyl chlorogenate [M+H]+ 10 V', dpi=100)

def test_simple_spectrum_plot_absolute_intensity():
    plot_mass_spectrum(v20, 'test_single_3.png', mz_min=70, mz_max=420, scale=None,
                       title='MZNIJRAPCCELQX-AWOKGZDASA-N: methyl chlorogenate [M+H]+ 10 V', dpi=100)

def test_head_to_tails_plot():
    plot_head_to_tail_mass_spectra(v10, v40, 'test_head_to_tails.png', labels=['10 V', '40 V'], mz_min=70, mz_max=420,
                                   title='MZNIJRAPCCELQX-AWOKGZDASA-N: methyl chlorogenate [M+H]+', dpi=100)

def test_multiplot():
    plot_multiple_mass_spectra([v10, v20, v40], 'test_multi.png', labels=['10 V', '20 V', '40 V'],
                               title='MZNIJRAPCCELQX-AWOKGZDASA-N: methyl chlorogenate [M+H]+',
                               mz_min=70, mz_max=420, dpi=100)
